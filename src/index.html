<!DOCTYPE html>
<html lang="zh">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="keywords"
        content="姓名.我是你爹.com,大儿砸.我是你爹.com,我是你爹.com,我是你爹,爹,爸爸,父亲,儿子,好大儿,大儿子,大儿砸,儿子,好闺女,大闺女,闺女,哥们,哥们儿,兄弟,室友,同学,整人,整蛊,整活,恶搞,笑话">
    <meta name="description" content="姓名.我是你爹.com，无负担当爹，让你体验一分钟当爹，当一分钟爹的乐趣。">
    <title>我是你爹！</title>
    <link rel="shortcut icon" href="./imgs/common/favicon.ico" type="image/x-icon">
    <link rel="stylesheet" href="./css/index.css">
    <link rel="stylesheet" href="./css/unreset.css">
    <link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/6.1.1/css/all.min.css">
    <script src="./js/punycode.js"></script>
    <script src="./js/pinyin-pro.js"></script>
    <script src="./js/fastscan.min.js"></script>
    <script src="https://cdn.staticfile.org/jquery/3.6.0/jquery.min.js"></script>
    <script src="https://cdn.staticfile.org/dompurify/2.3.8/purify.min.js"></script>
    <script src="https://cdn.staticfile.org/marked/4.0.17/marked.min.js"></script>
</head>

<body>
    <!-- 需要动态设置的类，先在这里添加以让 Tailwind CSS 编译，这种方法不知道行不行，我看有的样式会用变量 -->
    <div class="dh-tailwind-css-classes-init hidden">
        <!-- 一级标题保留 -->
        <h1>我是你爹.com</h1>
        <!-- forerunner 模板在动态调整 Markdown 图片时用到的样式，其中 lg:max-w-3/5 在配置文件中定制，并且已经试验过了，断点也是要编译的 -->
        <!-- text-blue-500 hover:underline 是 Markdown 解析的链接的颜色 -->
        <!-- hover:text-blue-600 用于按钮 -->
        <!-- disabled:opacity-50 是正在提交数据时用在按钮上的 -->
        <!-- hover:underline 用于右下角档案状态显示 -->
        <div
            class="dh-template-forerunner-styles lg:max-w-3/5 mx-auto my-4 object-scale-down text-blue-500 hover:text-blue-600 disabled:opacity-50 hover:underline">
        </div>
        <div class="dh-template-test-styles invisible"></div>
    </div>
    <!-- #region 顶层屏幕 -->
    <div class="dh-top-screens absolute inset-0 z-50">
        <div class="dh-loading-screen absolute inset-0 bg-yellow-500">
            <div
                class="dh-loading absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 align-middle w-full text-center text-5xl font-bold text-white">
                加载中……</div>
        </div>
        <div class="dh-hint-screen hidden absolute inset-0 bg-yellow-500">
            <div
                class="dh-hint absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 align-middle w-full text-center text-5xl font-bold text-white">
                <div class="dh-loading-hint-title mb-6">
                    格式
                </div>
                <div class="hd-hint-text text-3xl">
                    <a class="dh-hint-link underline" href="https://大儿砸.我是你爹.com">
                        姓名.我是你爹.com
                    </a>
                </div>

            </div>
        </div>
        <div class="dh-name-change-screen hidden absolute inset-0 bg-blue-500">
            <div class="dh-name-change absolute p-16 text-9xl text-white">
                <div class="dh-name-change-title mb-16">
                    :(
                </div>
                <div class="dh-name-change-text font-normal text-3xl">
                    你的网页遇到问题，需要换一个名字。
                </div>
            </div>
        </div>
        <!-- #region 操作屏幕 -->
        <div class="dh-operation-screen hidden absolute inset-0 bg-black bg-opacity-50">
            <!-- 需要 overflow-hidden -->
            <div
                class="dh-operation-panel w-5/6 h-4/5 md:w-2/5 absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 overflow-hidden rounded-xl bg-white">
                <!-- 添加 z-10 以免被下方绝对定位元素覆盖 -->
                <div
                    class="dh-operation-panel-close absolute right-0 w-12 h-12 flex items-center justify-center z-10 text-3xl text-red-500 hover:text-red-600 disabled:opacity-50">
                    <i class="fa-solid fa-xmark"></i>
                </div>
                <!-- #region “切换档案”节 -->
                <div class="dh-operation-section-profile-switch hidden absolute inset-0">
                    <div class="dh-profile-switch w-full h-full flex flex-col flex-nowrap p-6">
                        <div class="dh-profile-switch-title mb-6 text-2xl font-bold">切换档案</div>
                        <!-- 控件区域手动添加 block 类来使元素垂直排列，不使用 flex 因为 flex 在元素多的情况下会使元素 shrink -->
                        <div class="dh-profile-switch-elements flex-grow overflow-y-auto overscroll-contain space-y-2"
                            autocomplete="off" autocomplete="off">
                            <!-- select 加 px-1 bg-white -->
                            <select
                                class="dh-profile-switch-selections block w-64 h-8 px-1 bg-white outline-none border-2 border-gray-500">
                            </select>
                            <button
                                class="dh-profile-switch-confirm block w-24 h-10 rounded text-white bg-green-500 hover:bg-green-600 disabled:opacity-50">确定</button>
                        </div>
                    </div>
                </div>
                <!-- #endregion -->
                <!-- #region “编辑档案”节 -->
                <div class="dh-operation-section-profile-edit hidden absolute inset-0">
                    <div class="dh-profile-edit w-full h-full flex flex-col flex-nowrap p-6">
                        <div class="dh-profile-edit-title mb-6 text-2xl font-bold">编辑档案</div>
                        <!-- 控件区域手动添加 block 类来使元素垂直排列，不使用 flex 因为 flex 在元素多的情况下会使元素 shrink -->
                        <div class="dh-profile-edit-elements flex-grow overflow-y-auto overscroll-contain space-y-2">
                            <div class="dh-profile-edit-types-title w-64 text-md">操作</div>
                            <!-- select 加 px-1 bg-white -->
                            <select
                                class="dh-profile-edit-types block w-64 h-8 px-1 bg-white outline-none border-2 border-gray-500"
                                autocomplete="off">
                                <option value="create">新建云端档案</option>
                                <option value="update">修改此云端档案</option>
                                <option value="delete">删除此云端档案</option>
                            </select>
                            <div class="dh-profile-edit-data space-y-2">
                                <div class="dh-profile-edit-name-title w-64 text-md">子女姓名*</div>
                                <input
                                    class="dh-profile-edit-name block w-64 h-8 px-2 outline-none border-2 border-gray-500"
                                    type="text" autocomplete="off">
                                <div class="dh-profile-edit-gender-title w-64 text-md">子女性别</div>
                                <!-- select 加 px-1 bg-white -->
                                <select
                                    class="dh-profile-edit-gender block w-64 h-8 px-1 bg-white outline-none border-2 border-gray-500"
                                    autocomplete="off">
                                    <option value="0">不选择</option>
                                    <option value="1">男</option>
                                    <option value="2">女</option>
                                </select>
                                <div class="dh-profile-edit-daddy-name-title w-64 text-md">父亲姓名*</div>
                                <input
                                    class="dh-profile-edit-daddy-name block w-64 h-8 px-2 outline-none border-2 border-gray-500"
                                    type="text" autocomplete="off">
                                <div class="dh-profile-edit-markdown-title w-64 text-md">文本（支持 Markdown）*</div>
                                <textarea
                                    class="dh-profile-edit-markdown w-64 h-64 px-2 resize outline-none border-2 border-gray-500"
                                    autocomplete="off"></textarea>
                                <div class="dh-profile-edit-template-title w-64 text-md">模板*</div>
                                <!-- select 加 px-1 bg-white -->
                                <select
                                    class="dh-profile-edit-template block w-64 h-8 px-1 bg-white outline-none border-2 border-gray-500"
                                    autocomplete="off">
                                </select>
                                <div class="dh-profile-edit-background-title w-64 text-md">背景图片 Url</div>
                                <input
                                    class="dh-profile-edit-background block w-64 h-8 px-2 outline-none border-2 border-gray-500"
                                    type="text" autocomplete="off">
                                <div class="dh-profile-edit-avatar-title w-64 text-md">子女头像 Url</div>
                                <input
                                    class="dh-profile-edit-avatar block w-64 h-8 px-2 outline-none border-2 border-gray-500"
                                    type="text" autocomplete="off">
                                <div class="dh-profile-edit-daddy-avatar-title w-64 text-md">父亲头像 Url</div>
                                <input
                                    class="dh-profile-edit-daddy-avatar block w-64 h-8 px-2 outline-none border-2 border-gray-500"
                                    type="text" autocomplete="off">
                                <div class="dh-profile-edit-cloud-music-id-title w-64 text-md">网易云音乐歌曲 Id</div>
                                <input
                                    class="dh-profile-edit-cloud-music-id block w-64 h-8 px-2 outline-none border-2 border-gray-500"
                                    type="text" autocomplete="off">
                            </div>
                            <div class="dh-profile-edit-warning w-64 text-md font-bold text-red-500">
                                <p>标注有 * 的为必填项。</p>
                                <p>本平台禁止提交涉政、涉恐、涉诈、黄赌毒等违法内容，违者将接受删除内容、屏蔽页面等处罚，点击“确定”即代表您同意相关规定。</p>
                            </div>
                            <button
                                class="dh-profile-edit-confirm block w-24 h-10 rounded text-white bg-green-500 hover:bg-green-600 disabled:opacity-50">确定</button>
                        </div>
                    </div>
                </div>
                <!-- #endregion -->
            </div>
        </div>
        <!-- #endregion -->
    </div>
    <!-- #endregion -->
    <div class="dh-root absolute inset-0">
        <!-- #region “先行者”模板 -->
        <div
            class="dh-about-btn cursor-pointer absolute right-0 bottom-0 w-14 h-14 z-40 flex items-center justify-center text-3xl text-red-500 hover:text-red-600" title="关于">
            <i class="fa-solid fa-circle-info"></i>
        </div>
        <!-- 以 forerunner 为准 -->
        <!-- break-all：需要模板内所有的长串英文也换行 -->
        <!-- 希望 forerunner 模板占一屏，因此加 overflow-hidden 以防止内容溢出，一屏装不下 -->
        <div
            class="dh-template-forerunner hidden absolute inset-0 break-all overflow-hidden bg-cover bg-center bg-no-repeat bg-fixed bg-blue-50">
            <!-- 最好是通过设置 margin 来调整各项间距，因为 Tailwind CSS 的 space 会影响绝对定位的元素 -->
            <!-- 使用 Tailwind CSS 设计时以小屏优先，大屏加断点 -->
            <div
                class="dh-content absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 w-5/6 md:w-3/5 h-5/6 md:h-4/5 flex flex-col flex-nowrap">
                <div class="dh-title ml-6 mb-12 text-left text-5xl font-bold">
                    <div class="dh-title-name inline"></div>
                    <div class="dh-title-text inline">，我是你爹！</div>
                </div>
                <!-- card 的 overflow-hidden 不能省，省了就溢出，因为 card 无固定高度，markdown 也无固定高度 -->
                <div
                    class="dh-card flex-grow flex flex-col flex-nowrap px-6 py-6 overflow-hidden rounded-3xl border-2 border-blue-300 shadow-2xl bg-white">
                    <!-- 又包了一层。hidden 和 flex 不能加在同一元素上，因为 Tailwind CSS 的 hidden 实际上是 display: none -->
                    <!-- 现在提供了默认头像，不再使用 hidden -->
                    <div class="dh-avatar-group absolute right-12 -mt-16">
                        <div class="dh-avatars flex flex-nowrap items-center">
                            <div
                                class="dh-avatar w-14 h-14 mr-4 overflow-hidden rounded-md shadow-md border-2 border-blue-300">
                                <!-- 似乎指定了宽高，object-cover 才会工作 -->
                                <img class="dh-avatar-img h-14 w-full object-cover" />
                            </div>
                            <div
                                class="dh-daddy-avatar w-20 h-20 overflow-hidden rounded-md shadow-md border-2 border-blue-300">
                                <img class="dh-daddy-avatar-img h-20 w-full object-cover" />
                            </div>
                        </div>
                    </div>
                    <div class="dh-markdown unreset mb-6 flex-grow overflow-y-auto overscroll-contain">
                    </div>
                    <div class="dh-card-tail flex flex-nowrap justify-between">
                        <div class="dh-functions flex flex-nowrap">
                            <div
                                class="dh-function-btn-switch-profile cursor-pointer w-12 h-12 mr-4 flex items-center justify-center text-3xl text-blue-500 hover:text-blue-600" title="切换档案">
                                <i class="fa-regular fa-address-card"></i>
                            </div>
                            <div
                                class="dh-function-btn-edit-profile cursor-pointer w-12 h-12 mr-4 flex items-center justify-center text-3xl text-blue-500 hover:text-blue-600" title="编辑档案">
                                <i class="fa-solid fa-user-pen"></i>
                            </div>
                        </div>
                        <div class="dh-daddy text-right flex items-center justify-center text-xl font-bold">
                            <!-- 用 flex 是为了文字垂直居中，但会导致里面两个行内 div 在宽度不足时各自换行，需要用 wrapper 修复 -->
                            <div class="dh-daddy-wrapper">
                                <div class="dh-daddy-text inline">爱你的爸爸，</div>
                                <div class="dh-daddy-name inline"></div>
                            </div>
                        </div>
                        <div
                            class="dh-profile-info cursor-pointer absolute right-6 bottom-2 text-right text-xs text-gray-500 hover:underline">
                        </div>
                    </div>
                </div>
            </div>
            <div class="dh-music hidden absolute bottom-0">
            </div>
        </div>
        <!-- #endregion -->
        <!-- #region “测试”模板 -->
        <!-- <div
            class="dh-template-test hidden absolute inset-0 break-all overflow-hidden bg-cover bg-center bg-no-repeat bg-fixed bg-white">
            <div
                class="dh-content absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 w-5/6 md:w-3/5 h-5/6 md:h-4/5 flex flex-col flex-nowrap">
                <div class="dh-title ml-6 mb-12 text-left text-5xl font-bold">
                    <div class="dh-title-name inline"></div>
                    <div class="dh-title-text inline">，我是你爹！</div>
                </div>
                <div
                    class="dh-card flex-grow flex flex-col flex-nowrap px-6 py-6 overflow-hidden rounded-3xl border-2 border-stone-300 shadow-2xl bg-stone-50">
                    <div class="dh-avatar-group absolute right-12 -mt-16">
                        <div class="dh-avatars flex flex-nowrap items-center">
                            <div
                                class="dh-avatar w-14 h-14 mr-4 overflow-hidden rounded-md shadow-md border-2 border-stone-300">
                                <img class="dh-avatar-img h-14 w-full object-cover" />
                            </div>
                            <div
                                class="dh-daddy-avatar w-20 h-20 overflow-hidden rounded-md shadow-md border-2 border-stone-300">
                                <img class="dh-daddy-avatar-img h-20 w-full object-cover" />
                            </div>
                        </div>
                    </div>
                    <div class="dh-markdown unreset mb-6 flex-grow overflow-y-auto overscroll-contain">
                    </div>
                    <div class="dh-card-tail flex flex-nowrap justify-between">
                        <div class="dh-functions flex flex-nowrap">
                            <div
                                class="dh-function-btn-switch-profile cursor-pointer w-12 h-12 mr-4 flex items-center justify-center text-3xl text-gray-500 hover:text-gray-600">
                                <i class="fa-regular fa-address-card"></i>
                            </div>
                            <div
                                class="dh-function-btn-edit-profile cursor-pointer w-12 h-12 mr-4 flex items-center justify-center text-3xl text-gray-500 hover:text-gray-600">
                                <i class="fa-solid fa-user-pen"></i>
                            </div>
                        </div>
                        <div class="dh-daddy text-right flex items-center justify-center text-xl font-bold">
                            <div class="dh-daddy-wrapper">
                                <div class="dh-daddy-text inline">爱你的爸爸，</div>
                                <div class="dh-daddy-name inline"></div>
                            </div>
                        </div>
                        <div
                            class="dh-profile-info cursor-pointer absolute right-4 bottom-2 text-right text-xs text-gray-500">
                        </div>
                    </div>
                </div>
            </div>
            <div class="dh-music hidden absolute bottom-0">
            </div>
        </div> -->
        <!-- #endregion -->
        <!-- #region 调试用背景 -->
        <!-- 不加 overflow-hidden 的话，浏览器过窄，文字换行溢出露馅 -->
        <div class="dh-pale absolute inset-0 -z-50 overflow-hidden">
            <p>空白 - 顷刻间，你被抽离原来的维度，马丁内斯的旧影仍在脑际徘徊，但在这里，占据你的是*毫无意义*的空白。</p>
            <br>
            <p>你 - “朵拉？”</p>
            <br>
            <p>空白 - ……</p>
            <br>
            <p>五感发达（视觉） [炼狱：失败] - 除了空白，你什么也看不到。</p>
            <br>
            <p>五感发达（听觉） [炼狱：失败] - 除了空白，你什么也听不到。</p>
            <br>
            <p>五感发达（嗅觉） [炼狱：失败] - 除了空白，你什么也闻不到。</p>
            <br>
            <p>平心定气 [极易：成功] - 除了空白，你什么也*感觉*不到。</p>
            <br>
            <p>博学多闻 [中等：成功] - 无色、无味、无特征且坚不可摧、永垂不朽。显然，这是一片*灰域*。</p>
            <br>
            <p>见微知著 [中等：成功] - 在久远的过去，开发者泼洒出这片灰域，也许是用于调试，也许是为了一点点乐趣。</p>
            <br>
            <p>解锁成就：灰域行者</p>
        </div>
        <!-- #endregion -->
    </div>
    <script>
        const DEV = true;
        // const DEV = false;
        console.log('瞅什么瞅，我是你爹！');
        $('.dh-about-btn').click(() => {
            alert('仅为玩笑，切莫当真。\n如果您觉得权力、名誉等受到侵犯，或发现了不适宜甚至违法的内容，通常可以直接删除。如果档案受保护或在本地生成无法删除，请联系 bianyukun1213@outlook.com。十分抱歉，并感谢您的反馈！');
        });
        let hostSplited;
        if (DEV) {
            hostSplited = punycode.ToUnicode('xn--v4qp6qz71a.xn--6qq986bm4cjwp.com').split('.'); // 大儿砸.我是你爹.com
        }
        else {
            hostSplited = punycode.ToUnicode(window.location.host).split('.');
        }
        if (hostSplited.length !== 3) {
            window.location.href = 'https://大儿砸.我是你爹.com';
        }
        else {
            let { pinyin } = pinyinPro; // 引入 pinyinPro
            // #region 敏感姓名检测
            function encodeStr(str, offset) {
                let encoded = '';
                for (let i = 0, length = str.length; i < length; i++) {
                    let pos = str.charCodeAt(i);
                    let posWithOffset = pos + offset;
                    encoded += String.fromCharCode(posWithOffset);
                }
                return encoded;
            }
            // 转小写，去掉各种符号（包括零宽字符）、音调、空格，严格模式下只保留英文字母
            function removeSymbols(str, strict) {
                if (strict) {
                    return str.toLowerCase().replace(/[^a-z]/g, '');
                }
                return str.toLowerCase().normalize('NFD').replace(/[\p{C}\p{M}\p{N}\p{P}\p{S} ]/gu, '');
            }
            // 检测
            function isWordValid(str) {
                // 移除符号，转拼音，检测
                // 匹配 min哈gan哈xing哈ming
                let onlyEngChars = removeSymbols(str, true);
                // 匹配 mingan姓名
                let pinyinWithNonZh = pinyin(removeSymbols(str), { toneType: 'none', mode: 'surname', removeNonZh: false }).replace(/ /g, '');
                // 匹配 敏ha感ha姓ha名
                let pinyinWithoutNonZh = pinyin(removeSymbols(str), { toneType: 'none', mode: 'surname', removeNonZh: true }).replace(/ /g, '');
                let valid = scanner.search(onlyEngChars, { quick: true, longest: false }).length === 0 ? true : false;
                valid = valid && (scanner.search(pinyinWithNonZh, { quick: true, longest: false }).length === 0 ? true : false);
                return valid && (scanner.search(pinyinWithoutNonZh, { quick: true, longest: false }).length === 0 ? true : false);
            }
            // #endregion
            // #region 各种常量
            const NAME_LENGTH = 16;
            $('.dh-profile-edit-name').attr('maxlength', NAME_LENGTH);
            const DADDY_NAME_LENGTH = 16;
            $('.dh-profile-edit-daddy-name').attr('maxlength', DADDY_NAME_LENGTH);
            const MARKDOWN_LENGTH = 1000;
            $('.dh-profile-edit-markdown').attr('maxlength', MARKDOWN_LENGTH);
            const MARKDOWN_DEMO = '在这里你可以写普通的文本，也可以写 Markdown 格式的文本。\n\n我这就教你怎么写。\n\n请记住，段落之间留有一行，就像这样。\n\n# 井号和空格打头表示一级标题\n\n## 两个井号就是二级标题\n\n### 以此类推……\n\n但提交时请**不要**包含一级标题，因为一个网页应该只有一个一级标题，而这个一级标题我保留了。\n\n星号包裹文字，使之变成*斜体字*。\n\n两边各包两个星号，那么它就是**粗体字**。\n\n要使用~~删除线~~，两边各包两个波浪号。\n\n- 减号和空格打头表示这是一个无序列表，各项之间无需再留一行\n- 你试试\n\n1. 数字、点和空格打头，就成了有序列表\n2. 这是第二项\n\n还可以放图片：\n\n![这里写替换文本；图片 Url 写在小括号内](https://s1.ax1x.com/2022/07/12/jgGz1s.png)\n\n还有更多用法，可以看 [这个教程](https://www.runoob.com/markdown/md-tutorial.html)。这里碍于篇幅就不一一介绍了。对了，链接的格式和图片很像，只不过没有前面的叹号。\n';
            const CLOUD_MUSIC_ID_LENGTH = 24;
            const NAME_STR = hostSplited[0];
            const MARKDOWNS = [
                '都多大了，啥前儿能找个对象啊？\n\n从你爹这里遗传了这么优良的基因、这么迷人的长相，怎么可能没人追呢？\n\n……\n\n（啊？有对象啊？啥前儿搞的？咋不告诉爹呢？）',
                '没想到都这么大了，差点儿就认不出来了。\n\n是老爹亏欠了你和你妈啊，当年抛下你娘俩儿去闯荡江湖，好在最终神功练成了！\n\n老爹这就把神功传授给你，就当是对你的补偿了。\n\n《葵花宝典》看到没，都绝版了，这是老爹当年省吃俭用买的二手盗版，现在可是连盗版都找不着了！\n\n……\n\n“**欲练此功，必先自宫**。”\n\n……\n\n欸，我刀呢？拿回来，听话。一会儿就完事儿了，不疼，你老爹也是这么过来的。',
                '……\n\n这啥？\n\n娃儿？我啥时候有娃儿了？\n\n……\n\n噢噢噢，想起来了，大前年办宽带送的，一直没用，都落灰了。也用不上，卖了吧。\n\n……\n\n“小孩儿 是公是母不知道 就开了封，没用过 便宜出 可小刀 **仅限同城交易**”',
                '你瞅瞅你，一天天扬了二正、吊儿郎当儿的，能有点儿出息不？\n\n你要明白，爸爸的公司将来是要交给你运营的，你现在这副样子，让我怎么放心？你这个能力，世界五百强的公司，你驾驭得住？\n\n我跟你说，好好学习吧！良药苦口利于病，忠言逆耳利于行，我这都是**为你好**，你也别嫌我磨叽。对你严格是让你将来有个好的出路，到时候你会感激的。虎父无犬子吗不是？**别让你老爹失望**。',
                '这是哈阿\n\n网站 是什厶.\n\n大儿孑,大闰女教丿教老爹乍用、整不明曰阿|'
            ];
            const DADDY_NAMES = ['默默无闻的老父亲', '某神秘男子', '不知死活的网友', '浏览器', '隐世多年的银河首富', '亚洲第一帅', '火星驻地球大使', '隔壁老王', '某非洲酋长', '高龄猛♂男'];
            // #region 各种敏感姓名
            const BANNED_WORDS = [
                "uiwmlwvo",
                "pw}mvtiq",
                "tq}{piwyq",
                "p}lm",
                "xmvolmp}iq",
                "tqvjqiw",
                "tq}jwkpmvo",
                "kpmvq",
                "pmtwvo",
                "vqmzwvopmv",
                "}qivoyqiv",
                "t}wzwvop}iv",
                "mrqivqvo",
                "tqlipiw",
                "kpmvl}q}",
                "}vpwvo{piv",
                "}vmv",
                "}vqqiv",
                "lmvoqiwxqvo",
                "kpmv}v",
                "rqivomuqv",
                "tqxmvo",
                "p}zwvorq",
                "tqz}qp}iv",
                "mqrqivpivo",
                "tqtivyqvo",
                "p}rqv|iw",
                "t}woiv",
                "mvrqijiw",
                "}jivoo}w",
                "mvoyqvopwvo",
                "rqiyqvotqv",
                "p}ivor}",
                "}o}ivpmvo",
                "tqpivokp}v",
                "}q",
                "p}qtqivo}",
                "mvoxmqiv",
                "kiwoivokp}iv",
                "|ivorqi}iv",
                "p}irqivuqv",
                "kpmvpqtq",
                "pivolmrqivo",
                "}pmvo{pmvo",
                "ivo}my}iv",
                "tq}}v{piv",
                "ivooivo",
                "ivopiwo}w",
                "tq}yq",
                "pmo}wyqivo",
                "o}wjwqwvo",
                "p}iwjivo",
                "qrqvxqvo",
                "tqsmyqivo",
                "pivooiwtq",
                "tq}ivlwvo",
                "xmvotq}iv",
                "ivoyq{piv",
                "p}io}wnmvo",
                "qlili",
                "q}ivxqvo",
                "p}p}q",
                "qp}q",
                "uiwp}q"
            ];
            // #endregion
            // #endregion
            // 解码敏感姓名数组
            for (let i = 0, length = BANNED_WORDS.length; i < length; i++) {
                BANNED_WORDS[i] = encodeStr(BANNED_WORDS[i], -8);
            }
            let scanner = new FastScanner(BANNED_WORDS);
            // 长度判断放前面，这样长度不合适直接拦掉，不用检测敏感姓名了
            let invalid = NAME_STR.length > NAME_LENGTH || !isWordValid(NAME_STR);
            if (!invalid) {
                // #region 操作面板一系列事件
                function IsDataValidToSubmit() {
                    let regPicUrl = /(http|https):\/\/([\w-]+\.)+[\w-]+(\/[\w- .\/?%&=]*)+\.(jpg|png|webp|gif)/;
                    let regFirstLevelTitle = /^ *# +.+$/gm; // Markdown 不应该包含一级标题，一级标题保留
                    let nameValid, daddyNameValid, markdownValid, backgroundValid, avatarValid, daddyAvatarValid, cloudMusicIdValid;
                    let name = $('.dh-profile-edit-name').val();
                    nameValid = isWordValid(name) && name.length > 0 && name.length <= NAME_LENGTH;
                    let daddyName = $('.dh-profile-edit-daddy-name').val();
                    daddyNameValid = isWordValid(daddyName) && daddyName.length > 0 && daddyName.length <= DADDY_NAME_LENGTH;
                    let markdown = $('.dh-profile-edit-markdown').val();
                    markdownValid = isWordValid(markdown) && !regFirstLevelTitle.test(markdown) && markdown.length > 0 && markdown.length <= MARKDOWN_LENGTH; // 不含一级标题
                    let background = $('.dh-profile-edit-background').val();
                    backgroundValid = background === '' ? true : regPicUrl.test(background);
                    let avatar = $('.dh-profile-edit-avatar').val();
                    avatarValid = avatar === '' ? true : regPicUrl.test(avatar);
                    let daddyAvatar = $('.dh-profile-edit-daddy-avatar').val();
                    daddyAvatarValid = daddyAvatar === '' ? true : regPicUrl.test(daddyAvatar);
                    let cloudMusicId = $('.dh-profile-edit-cloud-music-id').val();
                    cloudMusicIdValid = cloudMusicId === '' ? true : cloudMusicId.length <= CLOUD_MUSIC_ID_LENGTH;
                    return !!(nameValid && daddyNameValid && markdownValid && backgroundValid && avatarValid && daddyAvatarValid && cloudMusicIdValid);
                }
                function closeOperationScreen() {
                    $('.dh-profile-edit-name').val('');
                    $('.dh-profile-edit-gender').val('0'); // 设置 value 为 '0' 的一项选中
                    $('.dh-profile-edit-daddy-name').val('');
                    $('.dh-profile-edit-markdown').val(MARKDOWN_DEMO); // 提供 Markdown 示例
                    $('.dh-profile-edit-template').val(currentProfile.template);
                    $('.dh-profile-edit-background').val('');
                    $('.dh-profile-edit-avatar').val('');
                    $('.dh-profile-edit-daddy-avatar').val('');
                    $('.dh-profile-edit-cloud-music-id').val('');
                    $('.dh-operation-section-profile-edit').addClass('hidden');
                    $('.dh-operation-section-profile-switch').addClass('hidden');
                    $('.dh-operation-screen').addClass('hidden');
                    $('.dh-top-screens').addClass('hidden');
                }
                // 操作面板关闭按钮点击事件
                $('.dh-operation-panel-close').click(closeOperationScreen);
                // 切换档案按钮点击事件
                $('.dh-function-btn-switch-profile').click(() => {
                    $('.dh-profile-switch-selections option').remove();
                    for (let i = 0, length = onlineProfiles.length; i < length; i++) {
                        let p = onlineProfiles[i];
                        $('.dh-profile-switch-selections').append(`<option value='${p.id}'>${p.name}，${p.daddy}</option>`);
                    }
                    $('.dh-profile-switch-selections').append(`<option value="local">本地档案</option>`);
                    currentProfile.id ? $('.dh-profile-switch-selections').val(currentProfile.id) : $('.dh-profile-switch-selections').val('local'); // 设置 value 为 id 或 'local' 的一项选中
                    $('.dh-operation-section-profile-switch').removeClass('hidden');
                    $('.dh-operation-screen').removeClass('hidden');
                    $('.dh-top-screens').removeClass('hidden');
                    // 滚动的这句必须放在取消隐藏之后
                    $('.dh-profile-switch-elements').scrollTop(0);
                });
                // 切换档案确认事件
                $('.dh-profile-switch-confirm').click(() => {
                    let targetProfileId = $('.dh-profile-switch-selections').val();
                    if (targetProfileId !== 'local') {
                        for (let i = 0, length = onlineProfiles.length; i < length; i++) {
                            let p = onlineProfiles[i];
                            if (p.id === targetProfileId) {
                                switchProfile(p);
                                break;
                            }
                        }
                    } else {
                        switchProfile();
                    }
                    closeOperationScreen();
                });
                // 编辑档案按钮点击事件
                $('.dh-function-btn-edit-profile').click(() => {
                    if (currentProfile.id && !currentProfile.protected) {
                        $('.dh-profile-edit-types option[value="update"]').removeAttr('disabled', 'disabled');
                        $('.dh-profile-edit-types option[value="delete"]').removeAttr('disabled', 'disabled');
                    }
                    else {
                        $('.dh-profile-edit-types option[value="update"]').attr('disabled', 'disabled');
                        $('.dh-profile-edit-types option[value="delete"]').attr('disabled', 'disabled');
                    }
                    $('.dh-profile-edit-types').val('create'); // 设置 value 为 'create' 的一项选中
                    $('.dh-profile-edit-template option').remove();
                    for (let i = 0, length = TEMPLATES.length; i < length; i++) {
                        $('.dh-profile-edit-template').append(`<option value="${TEMPLATES[i].name}">${TEMPLATES[i].humanName}${TEMPLATES[i].name === currentProfile.template ? '（当前）' : ''}</option>`);
                    }
                    $('.dh-profile-edit-template').val(currentProfile.template);
                    $('.dh-profile-edit-gender').val('0'); // 设置 value 为 '0' 的一项选中
                    $('.dh-profile-edit-markdown').val(MARKDOWN_DEMO); // 提供 Markdown 示例
                    $('.dh-profile-edit-data').removeClass('hidden');
                    $('.dh-operation-section-profile-edit').removeClass('hidden');
                    $('.dh-operation-screen').removeClass('hidden');
                    $('.dh-top-screens').removeClass('hidden');
                    // 滚动的这句必须放在取消隐藏之后
                    $('.dh-profile-edit-elements').scrollTop(0);
                });
                // 编辑档案操作类型变更事件
                $('.dh-profile-edit-types').change(() => {
                    let value = $('.dh-profile-edit-types').val();
                    if (value === 'delete') {
                        $('.dh-profile-edit-data').addClass('hidden');
                    }
                    else {
                        if (value === 'update') {
                            $('.dh-profile-edit-name').val(currentProfile.name);
                            $('.dh-profile-edit-gender').val(currentProfile.gender);
                            $('.dh-profile-edit-daddy-name').val(currentProfile.daddy);
                            $('.dh-profile-edit-markdown').val(currentProfile.markdown);
                            $('.dh-profile-edit-template').val(currentProfile.template);
                            $('.dh-profile-edit-background').val(currentProfile.background);
                            $('.dh-profile-edit-avatar').val(currentProfile.avatar);
                            $('.dh-profile-edit-daddy-avatar').val(currentProfile.daddyAvatar);
                            $('.dh-profile-edit-cloud-music-id').val(currentProfile.cloudMusicId);
                        } else {
                            $('.dh-profile-edit-name').val('');
                            $('.dh-profile-edit-gender').val('0'); // 设置 value 为 '0' 的一项选中
                            $('.dh-profile-edit-daddy-name').val('');
                            $('.dh-profile-edit-markdown').val(MARKDOWN_DEMO); // 提供 Markdown 示例
                            $('.dh-profile-edit-template').val(currentProfile.template);
                            $('.dh-profile-edit-background').val('');
                            $('.dh-profile-edit-avatar').val('');
                            $('.dh-profile-edit-daddy-avatar').val('');
                            $('.dh-profile-edit-cloud-music-id').val('');
                        }
                        $('.dh-profile-edit-data').removeClass('hidden');
                    }
                });
                // 编辑档案确认事件
                $('.dh-profile-edit-confirm').click(() => {
                    let value = $('.dh-profile-edit-types').val();
                    if (currentProfile.protected && value !== 'create') {
                        alert('这份档案受保护，你无法修改或删除。');
                        return;
                    }
                    if (confirm('此操作无法撤回，数据无法恢复到之前的状态，是否继续？')) {
                        let name = $('.dh-profile-edit-name').val();
                        let gender = parseInt($('.dh-profile-edit-gender').val(), 10);
                        let daddyName = $('.dh-profile-edit-daddy-name').val();
                        let markdown = $('.dh-profile-edit-markdown').val();
                        let template = $('.dh-profile-edit-template').val();
                        let background = $('.dh-profile-edit-background').val();
                        let avatar = $('.dh-profile-edit-avatar').val();
                        let daddyAvatar = $('.dh-profile-edit-daddy-avatar').val();
                        let cloudMusicId = $('.dh-profile-edit-cloud-music-id').val();
                        if (value === 'create') {
                            if (!IsDataValidToSubmit()) {
                                alert('数据错误或不适宜！');
                                return;
                            }
                            $('.dh-operation-panel-close').attr('disabled', 'disabled');
                            $('.dh-profile-edit-confirm').attr('disabled', 'disabled');
                            dhPost({
                                entry: '/create',
                                data: JSON.stringify({
                                    name: name,
                                    gender: gender,
                                    daddy: daddyName,
                                    markdown: markdown,
                                    template: template,
                                    background: background,
                                    avatar: avatar,
                                    daddyAvatar: daddyAvatar,
                                    cloudMusicId: cloudMusicId
                                }),
                                success: (res) => {
                                    alert('成功！');
                                    closeOperationScreen();
                                    window.location.href = `https://${name}.我是你爹.com`;
                                },
                                fail: (status, code, msg) => {
                                    alert(`失败：${code ? msg : status}。`)
                                },
                                complete: () => {
                                    $('.dh-operation-panel-close').removeAttr('disabled');
                                    $('.dh-profile-edit-confirm').removeAttr('disabled');
                                }
                            });
                        }
                        if (value === 'update') {
                            if (!IsDataValidToSubmit()) {
                                alert('数据错误或不适宜！');
                                return;
                            }
                            $('.dh-operation-panel-close').attr('disabled', 'disabled');
                            $('.dh-profile-edit-confirm').attr('disabled', 'disabled');
                            dhPut({
                                entry: `/update-by-id/${currentProfile.id}`,
                                data: JSON.stringify({
                                    name: name,
                                    gender: gender,
                                    daddy: daddyName,
                                    markdown: markdown,
                                    template: template,
                                    background: background,
                                    avatar: avatar,
                                    daddyAvatar: daddyAvatar,
                                    cloudMusicId: cloudMusicId
                                }),
                                success: (res) => {
                                    alert('成功！');
                                    closeOperationScreen();
                                    window.location.href = `https://${name}.我是你爹.com`;
                                },
                                fail: (status, code, msg) => {
                                    alert(`失败：${code ? msg : status}。`)
                                },
                                complete: () => {
                                    $('.dh-operation-panel-close').removeAttr('disabled');
                                    $('.dh-profile-edit-confirm').removeAttr('disabled');
                                }
                            });
                        }
                        if (value === 'delete') {
                            $('.dh-operation-panel-close').attr('disabled', 'disabled');
                            $('.dh-profile-edit-confirm').attr('disabled', 'disabled');
                            dhDelete({
                                entry: `/delete-by-id/${currentProfile.id}`,
                                success: (res) => {
                                    alert('成功！');
                                    closeOperationScreen();
                                    window.location.href = `https://${name}.我是你爹.com`;
                                },
                                fail: (status, code, msg) => {
                                    alert(`失败：${code ? msg : status}。`)
                                },
                                complete: () => {
                                    $('.dh-operation-panel-close').removeAttr('disabled');
                                    $('.dh-profile-edit-confirm').removeAttr('disabled');
                                }
                            });
                        }
                    }
                });
                // #endregion
                function randomItem(array) {
                    return array[Math.floor((Math.random() * array.length))];
                }
                function getTemplate(name) {
                    for (let i = 0, length = TEMPLATES.length; i < length; i++) {
                        if (name === TEMPLATES[i].name) {
                            return TEMPLATES[i];
                        }
                    }
                }
                // #region 切换档案
                function switchProfile(profile) {
                    // 注意，这里 profile 里的 template 为与后端同一，都只是模板名称，需要获取模板对象使用 getTemplate
                    let luckyTemplate = randomItem(TEMPLATES);
                    let luckyMarkdown = randomItem(MARKDOWNS);
                    let luckyDaddy = randomItem(DADDY_NAMES);
                    let localProfile = {
                        name: NAME_STR,
                        daddy: luckyDaddy,
                        markdown: luckyMarkdown,
                        template: luckyTemplate.name
                    };
                    profile = profile || localProfile;
                    // profile.markdown = profile.markdown || localProfile.markdown; 已无必要，现在 markdown 在后端服务中是必须的
                    // profile.template 为空，或找不到对应模板，都会进入这里
                    if (typeof getTemplate(profile.template) === 'undefined') {
                        profile.template = localProfile.template;
                    }
                    if (JSON.stringify(currentProfile) !== '{}') {
                        getTemplate(currentProfile.template).destroy(currentProfile);
                    }
                    getTemplate(profile.template).initialize(profile);
                    $(document).attr('title', profile.name + '，我是你爹！');
                    if (profile.id) {
                        window.location.hash = profile.id;
                    }
                    else {
                        window.location.hash = '';
                    }
                    currentProfile = profile;
                }
                // #endregion
                // #region AJAX 请求封装
                function dhRequest(options) {
                    const BASE_URL = 'https://daddyshere.hollisdevhub.com/api/sons';
                    options = options || {};
                    let entry = options.entry || '';
                    let method = options.method || 'GET';
                    let contentType = options.contentType || 'application/json';
                    let data = options.data || {};
                    let success = (result, status, xhr) => {
                        if (result.code === 0) {
                            console.log(`${options.method} ${options.entry} 请求成功：`, JSON.parse(JSON.stringify(result))); // 之后任何对 result 的修改都会影响这里，所以打印的时候“复制”一份来打印原样
                            if (typeof options.success === 'function') {
                                options.success(result.result);
                            }
                            return;
                        }
                        else {
                            console.log(`${options.method} ${options.entry} 请求成功，但返回结果标记异常：`, JSON.parse(JSON.stringify(result)));
                            if (typeof options.fail === 'function') {
                                options.fail(status, result.code, result.msg);
                            }
                        }
                    };
                    let fail = (xhr, status, error) => {
                        console.log(`${options.method} ${options.entry} 请求失败：${status}, `, error);
                        if (typeof options.fail === 'function') {
                            options.fail(status);
                        }
                    };
                    let complete = (xhr, status) => {
                        if (typeof options.complete === 'function') {
                            options.complete();
                        }
                    };
                    $.ajax({
                        url: BASE_URL + entry,
                        type: method,
                        contentType: contentType,
                        data: data,
                        timeout: 5000,
                        beforeSend: () => {
                            console.log(`发送 AJAX 请求：${method} ${entry}，数据：`, data);
                        }
                    }).done(success).fail(fail).always(complete);
                }
                function dhGet(options) {
                    options = options || {};
                    options.method = 'GET';
                    dhRequest(options);
                }
                function dhPost(options) {
                    options = options || {};
                    options.method = 'POST';
                    dhRequest(options);
                }
                function dhPut(options) {
                    options = options || {};
                    options.method = 'PUT';
                    dhRequest(options);
                }
                function dhDelete(options) {
                    options = options || {};
                    options.method = 'DELETE';
                    dhRequest(options);
                }
                // #endregion
                const TEMPLATES = [
                    // #region “先行者”模板
                    {
                        name: 'forerunner',
                        humanName: '先行者',
                        data: {
                            avatars: [['./imgs/template-forerunner/daddy-1.webp', './imgs/template-forerunner/son-1.webp'], ['./imgs/template-forerunner/daddy-2.webp', './imgs/template-forerunner/son-2.webp']] // forerunner 模板提供默认头像，但模板并非必须提供默认头像。实际上，模板不一定显示头像。switchProfile 仅处理必需的数据，其他数据由模板自己处理
                        },
                        runtimeResources: {},
                        initialize: function (profile) {
                            // 用匿名函数的话，this 就指向 window 而不是模板对象了
                            console.log(`${profile.template} 模板初始化。`);
                            $(`.dh-template-${profile.template} .dh-title-name`).text(profile.name);
                            let daddyCensored = isWordValid(profile.daddy) ? profile.daddy : '❤️';
                            $(`.dh-template-${profile.template} .dh-daddy-name`).text(daddyCensored);
                            let luckyAvatar = randomItem(this.data.avatars);
                            if (profile.daddyAvatar) {
                                $(`.dh-template-${profile.template} .dh-daddy-avatar-img`).attr('src', profile.daddyAvatar);
                            }
                            else {
                                $(`.dh-template-${profile.template} .dh-daddy-avatar-img`).attr('src', luckyAvatar[0]);
                            }
                            if (profile.avatar) {
                                $(`.dh-template-${profile.template} .dh-avatar-img`).attr('src', profile.avatar);
                            }
                            else {
                                $(`.dh-template-${profile.template} .dh-avatar-img`).attr('src', luckyAvatar[1]);
                            }
                            if (profile.background) {
                                $(`.dh-template-${profile.template}`).css('background-image', `url(${profile.background})`);
                            }
                            let markdownCensored = isWordValid(profile.markdown) ? profile.markdown : '❤️';
                            $(`.dh-template-${profile.template} .dh-markdown`).html(DOMPurify.sanitize(marked.parse(markdownCensored)));
                            $(`.dh-template-${profile.template} .dh-markdown img`).addClass('mx-auto my-4 lg:max-w-3/5 object-scale-down');
                            // $(`.dh-template-${profile.template} .dh-markdown a`).addClass('text-blue-500 hover:text-blue-600');
                            $(`.dh-template-${profile.template} .dh-markdown a`).addClass('text-blue-500 hover:underline');
                            if (profile.cloudMusicId) {
                                $(`.dh-template-${profile.template} .dh-music`).html(`<iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=298 height=52 src="//music.163.com/outchain/player?type=2&id=${profile.cloudMusicId}&auto=1&height=32"></iframe>`);
                                $(`.dh-template-${profile.template} .dh-music`).removeClass('hidden');
                            }
                            let profileInfo = $(`.dh-template-${profile.template} .dh-profile-info`);
                            if (profile.id) {
                                profileInfo.text('云端档案');
                                if (profile.nameUnique) {
                                    profileInfo.text((index, oldContent) => {
                                        return oldContent + ' / 姓名唯一';
                                    });
                                }
                                if (profile.protected) {
                                    profileInfo.text((index, oldContent) => {
                                        return oldContent + ' / 受保护';
                                    });
                                }
                                else {
                                    profileInfo.text((index, oldContent) => {
                                        return oldContent + ` / 将于 ${profile.expiration.split('T')[0]} 过期`;
                                    });
                                }
                            }
                            else {
                                $(`.dh-template-${profile.template} .dh-profile-info`).text('本地档案');
                            }
                            profileInfo.click(() => {
                                alert('本地档案：使用 JavaScript 代码在浏览器中即时生成，不会保存\n云端档案：由云端返回，在云端保存\n姓名唯一：无法新建同名档案或修改某档案使其与之同名\n受保护：无法修改或删除，不会被自动删除\n将于某日过期：在某日自动删除');
                            });
                            $(`.dh-template-${profile.template}`).removeClass('hidden');
                            console.log(`${profile.template} 模板初始化完成。`);
                        },
                        destroy: function (profile) {
                            console.log(`${profile.template} 模板注销。`);
                            $(`.dh-template-${profile.template} .dh-title-name`).text('');
                            $(`.dh-template-${profile.template} .dh-daddy-name`).text('');
                            $(`.dh-template-${profile.template} .dh-avatar-img`).attr('src', '');
                            $(`.dh-template-${profile.template} .dh-daddy-avatar-img`).attr('src', '');
                            $(`.dh-template-${profile.template} .dh-markdown`).html('');
                            $(`.dh-template-${profile.template} .dh-music`).html('');
                            $(`.dh-template-${profile.template} .dh-music`).addClass('hidden');
                            $(`.dh-template-${profile.template} .dh-profile-info`).text('');
                            $(`.dh-template-${profile.template} .dh-profile-info`).unbind('click');
                            $(`.dh-template-${profile.template}`).addClass('hidden');
                            console.log(`${profile.template} 模板注销完成。`);
                        }
                    },
                    // #endregion
                    // #region “测试”模板
                    // {
                    //     name: 'test',
                    //     humanName: '测试',
                    //     data: {
                    //         avatars: [['./imgs/template-forerunner/daddy-1.webp', './imgs/template-forerunner/son-1.webp'], ['./imgs/template-forerunner/daddy-2.png', './imgs/template-forerunner/son-2.jpg']], // forerunner 模板提供默认头像，但模板并非必须提供默认头像。实际上，模板不一定显示头像。switchProfile 仅处理必需的数据，其他数据由模板自己处理
                    //         backgrounds: ['./imgs/template-forerunner/bg-1.jpg', './imgs/template-forerunner/bg-2.jpg']
                    //     },
                    //     runtimeResources: {},
                    //     initialize: function (profile) {
                    //         console.log(`${profile.template} 模板初始化。`);
                    //         $(`.dh-template-${profile.template} .dh-title-name`).text(profile.name);
                    //         let daddyCensored = search.Replace(profile.daddy, '❤️');
                    //         $(`.dh-template-${profile.template} .dh-daddy-name`).text(daddyCensored);
                    //         let luckyAvatar = randomItem(this.data.avatars);
                    //         if (profile.daddyAvatar) {
                    //             $(`.dh-template-${profile.template} .dh-daddy-avatar-img`).attr('src', profile.daddyAvatar);
                    //         }
                    //         else {
                    //             $(`.dh-template-${profile.template} .dh-daddy-avatar-img`).attr('src', luckyAvatar[0]);
                    //         }
                    //         if (profile.avatar) {
                    //             $(`.dh-template-${profile.template} .dh-avatar-img`).attr('src', profile.avatar);
                    //         }
                    //         else {
                    //             $(`.dh-template-${profile.template} .dh-avatar-img`).attr('src', luckyAvatar[1]);
                    //         }
                    //         let luckyBackground = randomItem(this.data.backgrounds);
                    //         if (profile.background) {
                    //             $(`.dh-template-${profile.template}`).css('background-image', `url(${profile.background})`);
                    //         }
                    //         else {
                    //             $(`.dh-template-${profile.template}`).css('background-image', `url(${luckyBackground})`);
                    //         }
                    //         let markdownCensored = search.Replace(profile.markdown, '❤️');
                    //         $(`.dh-template-${profile.template} .dh-markdown`).html(DOMPurify.sanitize(marked.parse(markdownCensored)));
                    //         $(`.dh-template-${profile.template} .dh-markdown img`).addClass('mx-auto my-4 lg:max-w-3/5 object-scale-down');
                    //         $(`.dh-template-${profile.template} .dh-markdown a`).addClass('text-blue-500');
                    //         if (profile.cloudMusicId) {
                    //             $(`.dh-template-${profile.template} .dh-music`).html(`<iframe frameborder="no" border="0" marginwidth="0" marginheight="0" width=298 height=52 src="//music.163.com/outchain/player?type=2&id=${profile.cloudMusicId}&auto=1&height=32"></iframe>`);
                    //             $(`.dh-template-${profile.template} .dh-music`).removeClass('hidden');
                    //         }
                    //         let profileInfo = $(`.dh-template-${profile.template} .dh-profile-info`);
                    //         if (profile.id) {
                    //             profileInfo.text('云端档案');
                    //             if (profile.nameUnique) {
                    //                 profileInfo.text((index, oldContent) => {
                    //                     return oldContent + ' / 姓名唯一';
                    //                 });
                    //             }
                    //             if (profile.protected) {
                    //                 profileInfo.text((index, oldContent) => {
                    //                     return oldContent + ' / 受保护';
                    //                 });
                    //             }
                    //             if (profile.reserved) {
                    //                 profileInfo.text((index, oldContent) => {
                    //                     return oldContent + ' / 长期保存';
                    //                 });
                    //             }
                    //             else {
                    //                 profileInfo.text((index, oldContent) => {
                    //                     return oldContent + ` / 将于 ${profile.expiration.split('T')[0]} 过期`;
                    //                 });
                    //             }
                    //         }
                    //         else {
                    //             $(`.dh-template-${profile.template} .dh-profile-info`).text('本地档案');
                    //         }
                    //         profileInfo.click(() => {
                    //             alert('本地档案：使用 JavaScript 代码在浏览器中即时生成，不会保存\n云端档案：由云端返回，在云端保存\n姓名唯一：无法创建同名档案或修改某档案使其与之同名\n受保护：无法修改或删除，不会被自动删除\n长期保存：不会被自动删除\n将于某日过期：在某日自动删除');
                    //         });
                    //         // initTemplateResource(`${profile.template}`);
                    //         let interval = setInterval(() => {
                    //             $(`.dh-template-${profile.template} .dh-title`).hasClass('invisible') ? $(`.dh-template-${profile.template} .dh-title`).removeClass('invisible') : $(`.dh-template-${profile.template} .dh-title`).addClass('invisible');
                    //         }, 1000);
                    //         // setTemplateResource(`${profile.template}`, 'blink', interval);
                    //         this.runtimeResources.blink = interval;
                    //         $(`.dh-template-${profile.template}`).removeClass('hidden');
                    //         console.log(`${profile.template} 模板初始化完成。`);
                    //     },
                    //     destroy: function (profile) {
                    //         console.log(`${profile.template} 模板注销。`);
                    //         // 也许应该确保先清空 interval 再操作元素，假如没清空 interval 还删除了元素，interval 内留了个引用，会有内存泄漏吧？
                    //         // 当然也不是说现在一定就没有，我不是程序员，我啥也不懂
                    //         // let interval = getTemplateResource(`${profile.template}`, 'blink');
                    //         let interval = this.runtimeResources.blink;
                    //         clearInterval(interval);
                    //         // removeTemplateResource(`${profile.template}`, 'blink');
                    //         this.runtimeResources = {};
                    //         $(`.dh-template-${profile.template} .dh-title-name`).text('');
                    //         $(`.dh-template-${profile.template} .dh-daddy-name`).text('');
                    //         $(`.dh-template-${profile.template} .dh-avatar-img`).attr('src', '');
                    //         $(`.dh-template-${profile.template} .dh-daddy-avatar-img`).attr('src', '');
                    //         $(`.dh-template-${profile.template} .dh-markdown`).html('');
                    //         $(`.dh-template-${profile.template} .dh-music`).html('');
                    //         $(`.dh-template-${profile.template} .dh-music`).addClass('hidden');
                    //         $(`.dh-template-${profile.template} .dh-profile-info`).text('');
                    //         $(`.dh-template-${profile.template} .dh-profile-info`).unbind('click');
                    //         $(`.dh-template-${profile.template}`).addClass('hidden');
                    //         console.log(`${profile.template} 模板注销完成。`);
                    //     }
                    // }
                    // #endregion
                ];
                let currentProfile = {};
                let onlineProfiles = [];
                dhGet({
                    entry: `/get-by-name/${NAME_STR}`,
                    success: (res) => {
                        onlineProfiles = res;
                        let hashId = window.location.hash.replace('#', '');
                        if (hashId !== '') {
                            for (let i = 0, length = res.length; i < length; i++) {
                                if (hashId === res[i].id) {
                                    switchProfile(res[i]);
                                    return;
                                }
                            }
                        }
                        switchProfile(res[0]);
                    },
                    fail: () => { switchProfile(); },
                    complete: () => {
                        $('.dh-loading-screen').addClass('hidden');
                        $('.dh-top-screens').addClass('hidden'); // 直接隐藏掉顶层屏幕，不然顶层屏幕绝对定位，点击无法穿透
                    }
                });
            } else {
                $('.dh-loading-screen').addClass('hidden');
                $('.dh-name-change-screen').removeClass('hidden');
            }
        }
    </script>
</body>

</html>